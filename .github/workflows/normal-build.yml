name: normal-build-dist
on:
  push:
    branches:
      - master
jobs:
  build-docker-job:
    runs-on: ubuntu-latest
    steps:
      # 切换代码分支
      - name: checkout-release-code
        uses: actions/checkout@v3
      # 安装nodejs
      - name: add-node-env
      - uses: actions/setup-node@v3
        with:
          node-version: '16.x'
      # 缓存依赖
      - name: Cache
        id: cache-dependencies
        uses: actions/cache@v3
        with:
          path: |
            **/node_modules
      # 安装pnpm
      - name: install pnpm
        run: npm install -g pnpm

      # 安装依赖
      - name: Installing Dependencies
        run: pnpm install

      # build依赖
      - name: Build dist
        run: npm run build:client && npm run build:pilot && npm run build:server
